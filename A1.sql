-- Task 2: Created by Christopher Ekanem
DROP DATABASE IF EXISTS P3_TOPIC;
CREATE DATABASE P3_TOPIC;
USE P3_TOPIC;
SHOW DATABASES;

-- Task 3: Create tables by Christopher Ekanem
SHOW TABLES;
CREATE TABLE IF NOT EXISTS CLASS_CE(
	CODE_CE VARCHAR(2) PRIMARY KEY,
	LEVEL_CE VARCHAR(7) NOT NULL,
    COLOR_CE VARCHAR(5) NOT NULL,
    PHONE_CE CHAR(14) NOT NULL UNIQUE,
    CAPACITY_CE DECIMAL(2) NOT NULL,
    LOCATION_CE VARCHAR(130)
);
CREATE TABLE IF NOT EXISTS STUDENT_CE(
	ID_CE INT PRIMARY KEY,
    FIRST_CE VARCHAR(22) NOT NULL,
    LAST_CE VARCHAR(22) NOT NULL,
    MIDDLE_CE VARCHAR(22),
    NICKNAME_CE VARCHAR(20),
    DOB_CE DATE,
    CLASS_CODE_CE VARCHAR(2) NOT NULL,
    CITY_CE VARCHAR(15) NOT NULL,
    ZIPCODE_CE DECIMAL(5,0) NOT NULL,
    STREET_CE VARCHAR(35) NOT NULL,
    FOREIGN KEY (CLASS_CODE_CE) REFERENCES CLASS_CE(CODE_CE)
);
CREATE TABLE IF NOT EXISTS CARETAKER_CE(
	LAST_CE VARCHAR(22) NOT NULL,
	MOBILE_PHONE_CE CHAR(14) NOT NULL,
    FIRST_CE VARCHAR(22) NOT NULL,
    MIDDLE_CE VARCHAR(22),
    HOME_PHONE_CE CHAR(14),
    WORK_PHONE_CE CHAR(14),
    PERSONAL_EMAIL_CE VARCHAR(30),
    RELATIONSHIP_CE VARCHAR(25),
    PRIMARY KEY (LAST_CE, MOBILE_PHONE_CE)
);
CREATE TABLE IF NOT EXISTS TEACHER_CE(
	WORK_EMAIL_CE VARCHAR(30) PRIMARY KEY,
    FIRST_CE VARCHAR(22) NOT NULL,
    LAST_CE VARCHAR(22) NOT NULL,
    MIDDLE_CE VARCHAR(22),
    HOME_PHONE_CE CHAR(14) NOT NULL,
    PERSONAL_EMAIL_CE VARCHAR(30) UNIQUE,
    DEGREE_CE VARCHAR(5) NOT NULL,
    AREA_CE VARCHAR(25),
    TEACHER_CODE_CE VARCHAR(2),
    FOREIGN KEY (TEACHER_CODE_CE) REFERENCES CLASS_CE(CODE_CE)
);
CREATE TABLE IF NOT EXISTS REGISTRATION_CE(
	STUDENT_ID_CE INT NOT NULL,
    CARETAKER_MOBILE_CE VARCHAR(45) NOT NULL,
    CARETAKER_LAST_CE VARCHAR(22) NOT NULL,
    FOREIGN KEY (STUDENT_ID_CE) REFERENCES STUDENT_CE(ID_CE),
    FOREIGN KEY (CARETAKER_LAST_CE, CARETAKER_MOBILE_CE) REFERENCES CARETAKER_CE(LAST_CE, MOBILE_PHONE_CE),
    PRIMARY KEY (STUDENT_ID_CE, CARETAKER_MOBILE_CE, CARETAKER_LAST_CE)
);
SHOW TABLES;

-- Task 4: Add data by Christopher Ekanem
SELECT * FROM CLASS_CE;
SELECT * FROM STUDENT_CE; 
SELECT * FROM CARETAKER_CE;
SELECT * FROM TEACHER_CE;
SELECT * FROM REGISTRATION_CE;
INSERT INTO CLASS_CE (CODE_CE, LEVEL_CE, COLOR_CE, PHONE_CE, CAPACITY_CE, LOCATION_CE)
VALUES ('RT', 'TURTLES', 'RED', '(800) 456-8807', 25, ''),
('GF', 'FOXES', 'GREEN', '(800) 401-1156', 26, ''),
('BM', 'MONKEYS', 'BLUE', '(800) 097-5443', 27, ''),
('BT', 'TURTLES', 'BLUE', '(800) 256-5783', 28, ''),
('RF', 'FOXES', 'RED', '(800) 111-4060', 29, '');
INSERT INTO STUDENT_CE (ID_CE, FIRST_CE, LAST_CE, MIDDLE_CE, NICKNAME_CE, DOB_CE, 
CLASS_CODE_CE, CITY_CE, ZIPCODE_CE, STREET_CE)
VALUES (1, 'JEFFREY', 'SMITH', '', '', '2016-03-03', 'RT', 'FAIRFAX', '20332', 'AMBER LANE'),
(2, 'SAMANTHA', 'BURN', '', 'SAM', '2016-06-17', 'GF', 'FAIRFAX', '20332', 'LUCKY STREET'),
(3, 'HENRY', 'LOE', 'CHARLES', '', '2016-08-09', 'BM', 'RESTON', '20331', 'LOOM AVENUE'),
(4, 'LESLIE', 'REED', '', '', '2016-10-01', 'BT', 'LORTON', '20332', 'POOL BOULEVARD'),
(5, 'BOBBY', 'LEE', '', '', '2016-07-07', 'RF', 'RESTON', '20331', 'DUNE COURT');
INSERT INTO CARETAKER_CE (LAST_CE, MOBILE_PHONE_CE, FIRST_CE, MIDDLE_CE, 
HOME_PHONE_CE, WORK_PHONE_CE, PERSONAL_EMAIL_CE, RELATIONSHIP_CE)
VALUES ('SMITH', '(240) 456-8622', 'SUSAN', '', '(301) 033-4003', '', '', 'MOTHER'),
('BURN', '(240) 300-4021', 'CHARLES', 'POKE', '', '', '', 'FATHER'),
('LOE', '(240) 543-1001', 'VICTORIA', '', '', '', 'LOE22@GMAIL.COM', 'MOTHER'),
('REED', '(240) 707-3891', 'YOSELIN', 'CHART', '(301) 781-9320', '', '', 'AUNT'),
('LEE', '(240) 900-4644', 'CHAO', '', '', '', 'LEEYCHAO@GMAIL.COM', 'MOTHER');
INSERT INTO TEACHER_CE (WORK_EMAIL_CE, FIRST_CE, LAST_CE, MIDDLE_CE, HOME_PHONE_CE, 
PERSONAL_EMAIL_CE, DEGREE_CE, AREA_CE, TEACHER_CODE_CE)
VALUES ('SCRINCH3021@VAPS.COM', 'SUSANE', 'CRINCH', 'WRIGHT', '(301) 540-2210', 
'SUSCRINCH44@GMAIL.COM', 'TUBS', 'CHILDHOOD LEARNING', 'RT'),
('KPOLLEN3027@VAPS.COM', 'KATIE', 'POLLEN', '', '(301) 808-4004', 
'KP0KP0@GMAIL.COM', 'GMUBS', 'CHILDHOOD BEHAVIORALISM', 'GF'),
('RYOURKEY3029@VAPS.COM', 'RYAN', 'YOURKEY', '', '(301) 007-1132', 
'RYOUMD3322@GMAIL.COM', 'UMDMA', 'EDUCATIONAL TEACHING', 'BM'),
('GMONROE3019@VAPS.COM', 'GIGI', 'MONROE', '', '(301) 444-5115', 
'GIGODDESS1122@GMAIL.COM', 'UMDBS', '', 'BT'),
('LCLEME3010@VAPS.COM', 'LOUIE', 'CLEME', '', '(301) 477-5515', 
'CLEMENTINE33@GMAIL.COM', 'VTBS', '', 'RF');
INSERT INTO REGISTRATION_CE (STUDENT_ID_CE, CARETAKER_MOBILE_CE, CARETAKER_LAST_CE)
VALUES (1, '(240) 456-8622', 'SMITH'),
(2, '(240) 300-4021', 'BURN'),
(3, '(240) 543-1001', 'LOE'),
(4, '(240) 707-3891', 'REED'),
(5, '(240) 900-4644', 'LEE');
SELECT * FROM CLASS_CE;
SELECT * FROM STUDENT_CE; 
SELECT * FROM CARETAKER_CE;
SELECT * FROM TEACHER_CE;
SELECT * FROM REGISTRATION_CE;

-- Task 5: Query the data by Christopher Ekanem
SELECT CONCAT(STUDENT_CE.FIRST_CE, ' ', STUDENT_CE.LAST_CE) AS Student, CLASS_CE.LEVEL_CE AS Level, 
CLASS_CE.COLOR_CE, CLASS_CE.LOCATION_CE, CONCAT(TEACHER_CE.FIRST_CE, ' ', TEACHER_CE.LAST_CE) AS Teacher
FROM STUDENT_CE 
JOIN CLASS_CE ON STUDENT_CE.CLASS_CODE_CE = CLASS_CE.CODE_CE
JOIN TEACHER_CE ON CLASS_CE.CODE_CE = TEACHER_CE.TEACHER_CODE_CE
ORDER BY Student ASC;
SELECT CLASS_CE.COLOR_CE AS Color, CLASS_CE.LEVEL_CE AS Level, CONCAT(STUDENT_CE.FIRST_CE, ' ', STUDENT_CE.LAST_CE) AS `Student Name`,
STUDENT_CE.ZIPCODE_CE AS Zipcode
FROM CLASS_CE 
INNER JOIN STUDENT_CE ON CLASS_CE.CODE_CE = STUDENT_CE.CLASS_CODE_CE
ORDER BY CLASS_CE.COLOR_CE, CLASS_CE.LEVEL_CE, `Student Name`;
SELECT c.FIRST_CE AS Parent_First_Name, c.LAST_CE AS Parent_Last_Name, c.WORK_PHONE_CE,
       s.FIRST_CE AS Student_First_Name, s.LAST_CE AS Student_Last_Name, cl.LEVEL_CE, cl.COLOR_CE
FROM CARETAKER_CE c
INNER JOIN REGISTRATION_CE r ON c.LAST_CE = r.CARETAKER_LAST_CE AND c.MOBILE_PHONE_CE = r.CARETAKER_MOBILE_CE
INNER JOIN STUDENT_CE s ON r.STUDENT_ID_CE = s.ID_CE
INNER JOIN CLASS_CE cl ON s.CLASS_CODE_CE = cl.CODE_CE
ORDER BY c.LAST_CE, c.FIRST_CE, s.LAST_CE, s.FIRST_CE, cl.LEVEL_CE, cl.COLOR_CE;
SELECT CONCAT(C.FIRST_CE, ' ', C.LAST_CE) AS `parent`, CONCAT(T.FIRST_CE, ' ', T.LAST_CE) AS `teacher`, 
CONCAT(S.FIRST_CE, ' ', S.LAST_CE) AS `student`
FROM CARETAKER_CE C
INNER JOIN REGISTRATION_CE R ON C.LAST_CE = R.CARETAKER_LAST_CE AND C.MOBILE_PHONE_CE = R.CARETAKER_MOBILE_CE
INNER JOIN STUDENT_CE S ON R.STUDENT_ID_CE = S.ID_CE
INNER JOIN CLASS_CE CL ON S.CLASS_CODE_CE = CL.CODE_CE
INNER JOIN TEACHER_CE T ON CL.CODE_CE = T.TEACHER_CODE_CE
ORDER BY C.LAST_CE, C.FIRST_CE, T.LAST_CE, T.FIRST_CE, S.LAST_CE, S.FIRST_CE;






